<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<style>
		body {
			width: 100%;
			height: 100%;
			overflow: hidden;
			background-color: black;
			color: white;
			text-align: center;
			vertical-align: center;
		}
		#container {
			position: fixed;
			width: 100%;
			height: 100%;
			bottom: 0;
			left: 0;
			overflow: hidden;

		}
		#splash {
			height: 100%;
		}
		#marquee {
		}

	</style>
</head>
<body>
	<table id="container">
		<tr>
			<td id="splash">
				SPLASH PLACEHOLDER
			</td>
		</tr>
		<tr>
			<td id="marquee">
				MARQUEE PLACEHOLDER
			</td>
		</tr>
	</table>

	<script type="text/javascript">
	var producers = [];
	var lastinterval;
	
	function setScrollingText(text){
		document.getElementById("marquee").innerHTML = text;
	}
	function setProducers(text){
		producers = text.split("%n");
		producers = producers.slice(0, -1); //get rid of the last %n
		//alert(JSON.stringify(producers));
	}
	function makeCredits(scrollyString, producersString, scrollSpeed, splashTime){
		if (splashTime === undefined) {
			splashTime = 2000;
		}
		splashTime = parseInt(splashTime); //Just in case
		
		if (scrollSpeed === undefined) {
			scrollSpeed = 30;
		}
		scrollSpeed = parseInt(scrollSpeed); //Just in case
		
		setScrollingText(scrollyString);
		setProducers(producersString);
		
		splashLoop(producers, 0, splashTime);
		setTimeout(rollMarquee, producers.length*splashTime, scrollSpeed);
	}
	
	function splashLoop(arr, index, time) {
		if (index === arr.length){
			return;
		}
		document.getElementById("splash").innerHTML = arr[index];
		setTimeout(splashLoop, time, arr, index+1, time)
	}

	function rollMarquee(speed){
		var div = document.getElementById("container");
		var bottom = 0;
		lastinterval = setInterval(function () {
			bottom = bottom + 1;
			div.style.bottom = bottom + "px";
			if(bottom > 1500){ //RUNAWAY CREDIT ALART - no seriously this will keep going if the player doesn't close the game between rounds
				clearInterval(lastinterval);
				window.location = 'byond://winset?id=mapwindow.credits;is-visible=false';
				return;
			}
		}, speed);
	};
	</script>
</body>
</html>
